<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>JSON Web Token Best Current Practices</title>
<meta content="Yaron Sheffer" name="author">
<meta content="Dick Hardt" name="author">
<meta content="Michael B. Jones" name="author">
<meta content="
       JSON Web Tokens, also known as JWTs, are URL-safe JSON-based security
 tokens that contain a set of claims that can be signed and/or encrypted.
 JWTs are being widely used and deployed as a simple security token
 format in numerous protocols and applications, both in the area of
 digital identity and in other application areas.  This Best Current
 Practices (BCP) specification updates RFC 7519 to provide actionable guidance
 leading to secure implementation and deployment of JWTs. 
       This BCP specification furthermore replaces the existing JWT BCP
 specification RFC 8725 to provide additional actionable guidance
 covering threats and attacks that have been discovered
 since RFC 8725 was published. 
    " name="description">
<meta content="xml2rfc 3.30.0" name="generator">
<meta content="JSON Web Token" name="keyword">
<meta content="JWT" name="keyword">
<meta content="JSON Object Signing and Encryption" name="keyword">
<meta content="JOSE" name="keyword">
<meta content="JSON Web Signature" name="keyword">
<meta content="JWS" name="keyword">
<meta content="JSON Web Encryption" name="keyword">
<meta content="JWE" name="keyword">
<meta content="attacks" name="keyword">
<meta content="Claims" name="keyword">
<meta content="Security" name="keyword">
<meta content="Cryptography" name="keyword">
<meta content="draft-ietf-oauth-rfc8725bis-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.30.0
    Python 3.12.11
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 5.3.1
    platformdirs 4.3.8
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.4
    setuptools 80.9.0
    wcwidth 0.2.13
-->
<link href="draft-ietf-oauth-rfc8725bis.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">JWT BCP</td>
<td class="right">August 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Sheffer, et al.</td>
<td class="center">Expires 1 March 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Web Authorization Protocol</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-oauth-rfc8725bis-latest</dd>
<dt class="label-obsoletes">Obsoletes:</dt>
<dd class="obsoletes">
<a href="https://www.rfc-editor.org/rfc/rfc8725" class="eref">8725</a> (if approved)</dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc7519" class="eref">7519</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-08-28" class="published">28 August 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Best Current Practice</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-03-01">1 March 2026</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">Y. Sheffer</div>
<div class="org">Intuit</div>
</div>
<div class="author">
      <div class="author-name">D. Hardt</div>
</div>
<div class="author">
      <div class="author-name">M. Jones</div>
<div class="org">Self-Issued Consulting</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">JSON Web Token Best Current Practices</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">JSON Web Tokens, also known as JWTs, are URL-safe JSON-based security
 tokens that contain a set of claims that can be signed and/or encrypted.
 JWTs are being widely used and deployed as a simple security token
 format in numerous protocols and applications, both in the area of
 digital identity and in other application areas.  This Best Current
 Practices (BCP) specification updates RFC 7519 to provide actionable guidance
 leading to secure implementation and deployment of JWTs.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">This BCP specification furthermore replaces the existing JWT BCP
 specification RFC 8725 to provide additional actionable guidance
 covering threats and attacks that have been discovered
 since RFC 8725 was published.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 1 March 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-target-audience" class="internal xref">Target Audience</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-conventions-used-in-this-do" class="internal xref">Conventions Used in this Document</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-threats-and-vulnerabilities" class="internal xref">Threats and Vulnerabilities</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-weak-signatures-and-insuffi" class="internal xref">Weak Signatures and Insufficient Signature Validation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-weak-symmetric-keys" class="internal xref">Weak Symmetric Keys</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-incorrect-use-and-compositi" class="internal xref">Incorrect Use and Composition of Encryption and Signature</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="auto internal xref">2.4</a>.  <a href="#name-plaintext-leakage-through-a" class="internal xref">Plaintext Leakage through Analysis of Ciphertext Length</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a href="#section-2.5" class="auto internal xref">2.5</a>.  <a href="#name-insecure-use-of-elliptic-cu" class="internal xref">Insecure Use of Elliptic Curve Encryption</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.6">
                <p id="section-toc.1-1.2.2.6.1"><a href="#section-2.6" class="auto internal xref">2.6</a>.  <a href="#name-multiplicity-of-json-encodi" class="internal xref">Multiplicity of JSON Encodings</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.7">
                <p id="section-toc.1-1.2.2.7.1"><a href="#section-2.7" class="auto internal xref">2.7</a>.  <a href="#name-substitution-attacks" class="internal xref">Substitution Attacks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.8">
                <p id="section-toc.1-1.2.2.8.1"><a href="#section-2.8" class="auto internal xref">2.8</a>.  <a href="#name-cross-jwt-confusion" class="internal xref">Cross-JWT Confusion</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.9">
                <p id="section-toc.1-1.2.2.9.1"><a href="#section-2.9" class="auto internal xref">2.9</a>.  <a href="#name-indirect-attacks-on-the-ser" class="internal xref">Indirect Attacks on the Server</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.10">
                <p id="section-toc.1-1.2.2.10.1"><a href="#section-2.10" class="auto internal xref">2.10</a>. <a href="#name-computation-cost-of-unreaso" class="internal xref">Computation Cost of Unreasonable Number of Hash Iterations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.11">
                <p id="section-toc.1-1.2.2.11.1"><a href="#section-2.11" class="auto internal xref">2.11</a>. <a href="#name-algorithm-verification-code" class="internal xref">Algorithm Verification Code Not Defensively Written</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.12">
                <p id="section-toc.1-1.2.2.12.1"><a href="#section-2.12" class="auto internal xref">2.12</a>. <a href="#name-jwe-decompression-bomb-atta" class="internal xref">JWE Decompression Bomb Attack</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.13">
                <p id="section-toc.1-1.2.2.13.1"><a href="#section-2.13" class="auto internal xref">2.13</a>. <a href="#name-jwt-format-confusion" class="internal xref">JWT Format Confusion</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-best-practices" class="internal xref">Best Practices</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-perform-algorithm-verificat" class="internal xref">Perform Algorithm Verification</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-use-appropriate-algorithms" class="internal xref">Use Appropriate Algorithms</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-validate-all-cryptographic-" class="internal xref">Validate All Cryptographic Operations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-validate-cryptographic-inpu" class="internal xref">Validate Cryptographic Inputs</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="auto internal xref">3.5</a>.  <a href="#name-ensure-cryptographic-keys-h" class="internal xref">Ensure Cryptographic Keys Have Sufficient Entropy</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="auto internal xref">3.6</a>.  <a href="#name-avoid-compression-of-encryp" class="internal xref">Avoid Compression of Encryption Inputs</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7">
                <p id="section-toc.1-1.3.2.7.1"><a href="#section-3.7" class="auto internal xref">3.7</a>.  <a href="#name-use-utf-8" class="internal xref">Use UTF-8</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.8">
                <p id="section-toc.1-1.3.2.8.1"><a href="#section-3.8" class="auto internal xref">3.8</a>.  <a href="#name-validate-issuer-and-subject" class="internal xref">Validate Issuer and Subject</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.9">
                <p id="section-toc.1-1.3.2.9.1"><a href="#section-3.9" class="auto internal xref">3.9</a>.  <a href="#name-use-and-validate-audience" class="internal xref">Use and Validate Audience</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.10">
                <p id="section-toc.1-1.3.2.10.1"><a href="#section-3.10" class="auto internal xref">3.10</a>. <a href="#name-do-not-trust-received-claim" class="internal xref">Do Not Trust Received Claims</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.11">
                <p id="section-toc.1-1.3.2.11.1"><a href="#section-3.11" class="auto internal xref">3.11</a>. <a href="#name-use-explicit-typing" class="internal xref">Use Explicit Typing</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.12">
                <p id="section-toc.1-1.3.2.12.1"><a href="#section-3.12" class="auto internal xref">3.12</a>. <a href="#name-use-mutually-exclusive-vali" class="internal xref">Use Mutually Exclusive Validation Rules for Different Kinds of JWTs</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.13">
                <p id="section-toc.1-1.3.2.13.1"><a href="#section-3.13" class="auto internal xref">3.13</a>. <a href="#name-limit-hash-iteration-count" class="internal xref">Limit Hash Iteration Count</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.14">
                <p id="section-toc.1-1.3.2.14.1"><a href="#section-3.14" class="auto internal xref">3.14</a>. <a href="#name-check-jwt-format-type" class="internal xref">Check JWT Format Type</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.15">
                <p id="section-toc.1-1.3.2.15.1"><a href="#section-3.15" class="auto internal xref">3.15</a>. <a href="#name-limit-jwe-decompression-siz" class="internal xref">Limit JWE Decompression Size</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-document-history" class="internal xref">Document History</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-draft-ietf-oauth-rfc8725bis" class="internal xref">draft-ietf-oauth-rfc8725bis-00</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-draft-sheffer-oauth-rfc8725" class="internal xref">draft-sheffer-oauth-rfc8725bis-02</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#appendix-A.3" class="auto internal xref">A.3</a>.  <a href="#name-draft-sheffer-oauth-rfc8725b" class="internal xref">draft-sheffer-oauth-rfc8725bis-01</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#appendix-A.4" class="auto internal xref">A.4</a>.  <a href="#name-draft-sheffer-oauth-rfc8725bi" class="internal xref">draft-sheffer-oauth-rfc8725bis-00</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">JSON Web Tokens, also known as JWTs  <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>, are URL-safe JSON-based security tokens
that contain a set of claims that can be signed and/or encrypted.
The JWT specification has seen rapid adoption because it encapsulates
security-relevant information in one easy-to-protect location, and because
it is easy to implement using widely available tools.
One application area in which JWTs are commonly used is representing digital identity information,
such as OpenID Connect ID Tokens  <span>[<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span>
and OAuth 2.0  <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span> access tokens and
 refresh tokens, the details of which are deployment-specific.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Since the JWT specification was published, there have been several widely published
attacks on implementations and deployments.
Such attacks are the result of under-specified security mechanisms, as well as incomplete
implementations and incorrect usage by applications.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">The goal of this document is to facilitate secure implementation and deployment of JWTs.
Many of the recommendations in this document are about
implementation and use of the cryptographic mechanisms underlying JWTs that are defined by
JSON Web Signature (JWS)  <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>,
JSON Web Encryption (JWE)  <span>[<a href="#RFC7516" class="cite xref">RFC7516</a>]</span>, and
JSON Web Algorithms (JWA)  <span>[<a href="#RFC7518" class="cite xref">RFC7518</a>]</span>.
Others are about use of the JWT claims themselves.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">These are intended to be minimum recommendations for the use of JWTs
in the vast majority of implementation
and deployment scenarios. Other specifications that reference this document can have
stricter requirements related to one or more aspects of the format, based on their
particular circumstances; when that is the case, implementers are advised to adhere
to those stricter requirements. Furthermore, this document provides a floor, not a ceiling,
so stronger options are always allowed (e.g., depending on differing evaluations of the
importance of cryptographic strength vs. computational load).<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">Community knowledge about the strength of various algorithms and feasible attacks can
change quickly, and experience shows that a Best Current Practice (BCP) document about
security is a point-in-time statement. Readers are advised to seek out any errata or
updates that apply to this document.<a href="#section-1-5" class="pilcrow">¶</a></p>
<div id="target-audience">
<section id="section-1.1">
        <h3 id="name-target-audience">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-target-audience" class="section-name selfRef">Target Audience</a>
        </h3>
<p id="section-1.1-1">The intended audiences of this document are:<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-2.1">
            <p id="section-1.1-2.1.1">Implementers of JWT libraries (and the JWS and JWE libraries
 used by those libraries),<a href="#section-1.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-2.2">
            <p id="section-1.1-2.2.1">Implementers of code that uses such libraries (to the extent that some mechanisms may
not be provided by libraries, or until they are), and<a href="#section-1.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-2.3">
            <p id="section-1.1-2.3.1">Developers of specifications that rely on JWTs, both inside and
 outside the IETF.<a href="#section-1.1-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="conventions-used-in-this-document">
<section id="section-1.2">
        <h3 id="name-conventions-used-in-this-do">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-conventions-used-in-this-do" class="section-name selfRef">Conventions Used in this Document</a>
        </h3>
<p id="section-1.2-1">The key words "MUST", "MUST NOT",
 "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT",
 "RECOMMENDED", "NOT RECOMMENDED",
 "MAY", and "OPTIONAL" in this document are
 to be interpreted as
 described in BCP 14  <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span>  <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span>
 when, and only when, they appear in all capitals, as shown here.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="threats-and-vulnerabilities">
<section id="section-2">
      <h2 id="name-threats-and-vulnerabilities">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-threats-and-vulnerabilities" class="section-name selfRef">Threats and Vulnerabilities</a>
      </h2>
<p id="section-2-1">This section lists some known and possible problems with JWT
 implementations and deployments.
Each problem description is followed by references to one or more mitigations to those problems.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="weak-signatures-and-insufficient-signature-validation">
<section id="section-2.1">
        <h3 id="name-weak-signatures-and-insuffi">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-weak-signatures-and-insuffi" class="section-name selfRef">Weak Signatures and Insufficient Signature Validation</a>
        </h3>
<p id="section-2.1-1">Signed JSON Web Tokens carry an explicit indication of the signing algorithm,
in the form of the "alg" Header Parameter, to facilitate cryptographic agility.
This, in conjunction with design flaws in some libraries and applications,
 has led to several attacks:<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-2.1">
            <p id="section-2.1-2.1.1">The algorithm can be changed to "none" by an attacker, and some libraries would trust
this value and "validate" the JWT without checking any signature.<a href="#section-2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-2.2">
            <p id="section-2.1-2.2.1">An "RS256" (RSA, 2048 bit) parameter value can be changed into
"HS256" (HMAC, SHA-256), and some libraries
would try to validate the signature using HMAC-SHA256 and using the RSA public key as the
HMAC shared secret (see  <span>[<a href="#McLean" class="cite xref">McLean</a>]</span> and
  <span>[<a href="#CVE-2015-9235" class="cite xref">CVE-2015-9235</a>]</span>).<a href="#section-2.1-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.1-3">For mitigations, see <a href="#algorithm-verification" class="auto internal xref">Section 3.1</a> and <a href="#appropriate-algorithms" class="auto internal xref">Section 3.2</a>.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="weak-symmetric-keys">
<section id="section-2.2">
        <h3 id="name-weak-symmetric-keys">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-weak-symmetric-keys" class="section-name selfRef">Weak Symmetric Keys</a>
        </h3>
<p id="section-2.2-1">In addition, some applications use a keyed Message Authentication
 Code (MAC) algorithm, such as
"HS256", to sign tokens but supply a weak symmetric key with
insufficient entropy (such as a human-memorable password). Such keys
are vulnerable to offline brute-force or dictionary attacks once an
attacker gets hold of such a token  <span>[<a href="#Langkemper" class="cite xref">Langkemper</a>]</span>.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">For mitigations, see  <a href="#key-entropy" class="auto internal xref">Section 3.5</a>.<a href="#section-2.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="incorrect-composition-of-encryption-and-signature">
<section id="section-2.3">
        <h3 id="name-incorrect-use-and-compositi">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-incorrect-use-and-compositi" class="section-name selfRef">Incorrect Use and Composition of Encryption and Signature</a>
        </h3>
<p id="section-2.3-1">Most authentication use cases only require a simple signed JWT as their token. However verifiers don't always check that the received JWT is a signed JWS as opposed to an encrypted JWE structure. This can result in vulnerabilities when the verifier's library does not distinguish between successful decryption and successful signature validation <span>[<a href="#CVE-2023-51774" class="cite xref">CVE-2023-51774</a>]</span>.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2">In the more complicated use cases where confidentiality is required, some libraries that decrypt a JWE-encrypted JWT to obtain a JWS-signed object
do not always validate the internal signature.<a href="#section-2.3-2" class="pilcrow">¶</a></p>
<p id="section-2.3-3">For mitigations, see  <a href="#validate-crypto" class="auto internal xref">Section 3.3</a>.<a href="#section-2.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="plaintext-leakage-through-analysis-of-ciphertext-length">
<section id="section-2.4">
        <h3 id="name-plaintext-leakage-through-a">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-plaintext-leakage-through-a" class="section-name selfRef">Plaintext Leakage through Analysis of Ciphertext Length</a>
        </h3>
<p id="section-2.4-1">Many encryption algorithms leak information about the length of the
 plaintext, with a varying amount of
leakage depending on the algorithm and mode of operation. This problem is exacerbated
when the plaintext is initially compressed, because the length of the
compressed plaintext and, thus,
the ciphertext
depends not only on the length of the original plaintext but also
on its content.
Compression attacks are particularly
powerful when there is attacker-controlled data in the same compression
space as secret data, which is the case for some attacks on HTTPS.<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<p id="section-2.4-2">See  <span>[<a href="#Kelsey" class="cite xref">Kelsey</a>]</span> for general background
on compression and encryption and  <span>[<a href="#Alawatugoda" class="cite xref">Alawatugoda</a>]</span> for a specific example of attacks on HTTP cookies.<a href="#section-2.4-2" class="pilcrow">¶</a></p>
<p id="section-2.4-3">For mitigations, see  <a href="#no-compression" class="auto internal xref">Section 3.6</a>.<a href="#section-2.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="insecure-use-of-elliptic-curve-encryption">
<section id="section-2.5">
        <h3 id="name-insecure-use-of-elliptic-cu">
<a href="#section-2.5" class="section-number selfRef">2.5. </a><a href="#name-insecure-use-of-elliptic-cu" class="section-name selfRef">Insecure Use of Elliptic Curve Encryption</a>
        </h3>
<p id="section-2.5-1">Per  <span>[<a href="#Sanso" class="cite xref">Sanso</a>]</span>, several Javascript
 Object Signing and Encryption (JOSE) libraries
 fail to validate their inputs correctly
when performing elliptic curve key agreement (the "ECDH-ES" algorithm).
An attacker that is able to send JWEs of its choosing that use invalid curve points and
observe the cleartext outputs resulting from decryption with the invalid curve points
can use this vulnerability to recover the recipient's private key.<a href="#section-2.5-1" class="pilcrow">¶</a></p>
<p id="section-2.5-2">For mitigations, see  <a href="#validate-inputs" class="auto internal xref">Section 3.4</a>.<a href="#section-2.5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="multiplicity-of-json-encodings">
<section id="section-2.6">
        <h3 id="name-multiplicity-of-json-encodi">
<a href="#section-2.6" class="section-number selfRef">2.6. </a><a href="#name-multiplicity-of-json-encodi" class="section-name selfRef">Multiplicity of JSON Encodings</a>
        </h3>
<p id="section-2.6-1">Previous versions of the JSON format, such as the obsoleted  <span>[<a href="#RFC7159" class="cite xref">RFC7159</a>]</span>,
allowed several different character
encodings: UTF-8, UTF-16, and UTF-32. This is not the case anymore, with the latest
standard  <span>[<a href="#RFC8259" class="cite xref">RFC8259</a>]</span> only allowing UTF-8 except
for internal use within a "closed ecosystem".
This ambiguity, where older implementations and those used within closed environments may generate
non-standard encodings, may result in the JWT being
misinterpreted by its recipient. This, in turn, could be used by a malicious sender to bypass
the recipient's validation checks.<a href="#section-2.6-1" class="pilcrow">¶</a></p>
<p id="section-2.6-2">For mitigations, see  <a href="#use-utf8" class="auto internal xref">Section 3.7</a>.<a href="#section-2.6-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="substitution">
<section id="section-2.7">
        <h3 id="name-substitution-attacks">
<a href="#section-2.7" class="section-number selfRef">2.7. </a><a href="#name-substitution-attacks" class="section-name selfRef">Substitution Attacks</a>
        </h3>
<p id="section-2.7-1">There are attacks in which one recipient will be given a JWT that was intended for it
and will attempt to use it at a different recipient for which that JWT was not intended.
For instance, if an OAuth 2.0  <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span> access
token is legitimately presented to an
OAuth 2.0 protected resource for which it is intended, that protected resource might then present
that same access token to a different protected resource for which the access token is not intended,
in an attempt to gain access. If such situations are not caught, this can result in
the attacker gaining access to resources that it is not entitled to access.<a href="#section-2.7-1" class="pilcrow">¶</a></p>
<p id="section-2.7-2">For mitigations, see Sections  <a href="#validate-iss-sub" class="auto internal xref">3.8</a> and  <a href="#use-aud" class="auto internal xref">3.9</a>.<a href="#section-2.7-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cross-jwt-confusion">
<section id="section-2.8">
        <h3 id="name-cross-jwt-confusion">
<a href="#section-2.8" class="section-number selfRef">2.8. </a><a href="#name-cross-jwt-confusion" class="section-name selfRef">Cross-JWT Confusion</a>
        </h3>
<p id="section-2.8-1">As JWTs are being used by more different protocols in diverse
 application areas, it becomes increasingly
important to prevent cases of JWT tokens that have been issued for one purpose
being subverted and used for another.
Note that this is a specific type of substitution attack.
If the JWT could be used in an application context in which it could be
confused with other kinds of JWTs,
then mitigations  MUST be employed to prevent these substitution attacks.<a href="#section-2.8-1" class="pilcrow">¶</a></p>
<p id="section-2.8-2">For mitigations, see Sections  <a href="#validate-iss-sub" class="auto internal xref">3.8</a>,  <a href="#use-aud" class="auto internal xref">3.9</a>,  <a href="#use-typ" class="auto internal xref">3.11</a>, and  <a href="#preventing-confusion" class="auto internal xref">3.12</a>.<a href="#section-2.8-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="indirect-attacks-on-the-server">
<section id="section-2.9">
        <h3 id="name-indirect-attacks-on-the-ser">
<a href="#section-2.9" class="section-number selfRef">2.9. </a><a href="#name-indirect-attacks-on-the-ser" class="section-name selfRef">Indirect Attacks on the Server</a>
        </h3>
<p id="section-2.9-1">Various JWT claims are used by the recipient to perform lookup operations,
such as database and Lightweight Directory Access Protocol (LDAP) searches.
Others include URLs that are similarly looked up by the server. Any of these claims can be used by
an attacker as vectors for injection attacks or server-side request forgery (SSRF) attacks.<a href="#section-2.9-1" class="pilcrow">¶</a></p>
<p id="section-2.9-2">For mitigations, see  <a href="#do-not-trust-claims" class="auto internal xref">Section 3.10</a>.<a href="#section-2.9-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="unreasonable-iterations">
<section id="section-2.10">
        <h3 id="name-computation-cost-of-unreaso">
<a href="#section-2.10" class="section-number selfRef">2.10. </a><a href="#name-computation-cost-of-unreaso" class="section-name selfRef">Computation Cost of Unreasonable Number of Hash Iterations</a>
        </h3>
<p id="section-2.10-1">The <code>p2c</code> (PBES2 Count) header parameter for the PBES2 encryption algorithms
specifies the number of iterative hash computations to be performed.
Attackers can use a very large count,
thereby imposing an unreasonable computational burden on recipients.<a href="#section-2.10-1" class="pilcrow">¶</a></p>
<p id="section-2.10-2">For mitigations, see <a href="#limit-iterations" class="auto internal xref">Section 3.13</a>.<a href="#section-2.10-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="autogen-algorithm-verification-code-not-defensively-written">
<section id="section-2.11">
        <h3 id="name-algorithm-verification-code">
<a href="#section-2.11" class="section-number selfRef">2.11. </a><a href="#name-algorithm-verification-code" class="section-name selfRef">Algorithm Verification Code Not Defensively Written</a>
        </h3>
<p id="section-2.11-1">Some JWT implementations included a list of disallowed algorithm names,
e.g., do not use "none".
These same applications misinterpreted
the JOSE specifications when parsing the token, reading algorithm values
as if they were case-insensitive. The end result was that an attacker
could change the "alg" value to "noNE" and bypass the security check.<a href="#section-2.11-1" class="pilcrow">¶</a></p>
<p id="section-2.11-2">For mitigations, see <a href="#algorithm-verification" class="auto internal xref">Section 3.1</a>.<a href="#section-2.11-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="autogen-jwe-decompression-bomb-attack">
<section id="section-2.12">
        <h3 id="name-jwe-decompression-bomb-atta">
<a href="#section-2.12" class="section-number selfRef">2.12. </a><a href="#name-jwe-decompression-bomb-atta" class="section-name selfRef">JWE Decompression Bomb Attack</a>
        </h3>
<p id="section-2.12-1">JWE supports the optional compression of the plaintext prior to encryption via the "zip" header parameter as defined in <span>[<a href="#RFC7516" class="cite xref">RFC7516</a>]</span> Section 4.1.3. Upon decryption, recipients are expected to decompress the payload before further processing. However, if the recipient does not enforce limits on the size of the decompressed output, an attacker can craft a malicious JWE with a highly compressed, arbitrarily large payload. This can cause excessive resource consumption (CPU, memory), resulting in Denial of Service (DoS).<a href="#section-2.12-1" class="pilcrow">¶</a></p>
<p id="section-2.12-2">For mitigation, see <a href="#limit-decompression" class="auto internal xref">Section 3.15</a>.<a href="#section-2.12-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="autogen-jwt-format-confusion">
<section id="section-2.13">
        <h3 id="name-jwt-format-confusion">
<a href="#section-2.13" class="section-number selfRef">2.13. </a><a href="#name-jwt-format-confusion" class="section-name selfRef">JWT Format Confusion</a>
        </h3>
<p id="section-2.13-1">Some JWS implementations support both the Compact and JSON Serializations. While JWTs MUST use the Compact Serialization, if an application by mistake verifies a JWT using the JSON Serialization but extracts claims by parsing it as a JWT using the Compact Serialization (e.g., via string splitting), an attacker can craft a valid JSON JWS with a forged payload. This mismatch in format handling can lead to authentication bypass or impersonation.<a href="#section-2.13-1" class="pilcrow">¶</a></p>
<p id="section-2.13-2">For mitigations, see <a href="#token-format" class="auto internal xref">Section 3.14</a>.<a href="#section-2.13-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="BP">
<section id="section-3">
      <h2 id="name-best-practices">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-best-practices" class="section-name selfRef">Best Practices</a>
      </h2>
<p id="section-3-1">The best practices listed below should be applied by practitioners
to mitigate the threats listed in the preceding section.<a href="#section-3-1" class="pilcrow">¶</a></p>
<div id="algorithm-verification">
<section id="section-3.1">
        <h3 id="name-perform-algorithm-verificat">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-perform-algorithm-verificat" class="section-name selfRef">Perform Algorithm Verification</a>
        </h3>
<p id="section-3.1-1">Libraries  MUST enable the caller to specify a
 supported set of algorithms and  MUST NOT use any other algorithms when performing cryptographic operations.
The library  MUST ensure that the "alg" or "enc" header specifies the same algorithm
that is used for the cryptographic operation.
Moreover, each key  MUST be used with exactly one algorithm,
and this  MUST be checked when the cryptographic operation is performed.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">Libraries SHOULD opt for defensive security policies to cope
with potential issues in the underlying infrastructure, such
as the JSON parser. In particular, use allowlists for critical
parameters such as "alg" instead of blocklists.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="appropriate-algorithms">
<section id="section-3.2">
        <h3 id="name-use-appropriate-algorithms">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-use-appropriate-algorithms" class="section-name selfRef">Use Appropriate Algorithms</a>
        </h3>
<p id="section-3.2-1">As  Section 5.2 of <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span> says,
"it is an application decision which algorithms may
be used in a given context. Even if a JWS can be successfully
validated, unless the algorithm(s) used in the JWS are acceptable to
the application, it  SHOULD consider the JWS to be invalid."<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">Therefore, applications  MUST only allow the use of
 cryptographically current algorithms
that meet the security requirements of the application.
This set will vary over time as new algorithms are introduced
and existing algorithms are deprecated due to discovered cryptographic weaknesses.
Applications  MUST therefore be designed to enable cryptographic agility.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">That said, if a JWT is cryptographically protected end-to-end by a
 transport layer, such as TLS
using cryptographically current algorithms, there may be no need to apply another layer of
cryptographic protections to the JWT.
In such cases, the use of the "none" algorithm can be perfectly acceptable.
The "none" algorithm should only be used when the JWT is cryptographically protected by other means.
JWTs using "none" are often used in application contexts in which the content is optionally signed;
then, the URL-safe claims representation and processing can be the same in both
the signed and unsigned cases.
JWT libraries  SHOULD NOT generate JWTs using "none" unless
explicitly requested to do so by the caller.
Similarly, JWT libraries  SHOULD NOT consume JWTs using "none"
 unless explicitly requested by the caller.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2-4">Applications  SHOULD follow these algorithm-specific recommendations:<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-5.1">
            <p id="section-3.2-5.1.1">Avoid all RSA-PKCS1 v1.5 encryption algorithms (<span>[<a href="#RFC8017" class="cite xref">RFC8017</a>]</span>, Section 7.2), preferring
 RSAES-OAEP
 (<span>[<a href="#RFC8017" class="cite xref">RFC8017</a>]</span>, Section 7.1).<a href="#section-3.2-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-5.2">
            <p id="section-3.2-5.2.1">Elliptic Curve Digital Signature Algorithm (ECDSA) signatures  <span>[<a href="#ANSI-X962-2005" class="cite xref">ANSI-X962-2005</a>]</span> require a unique random value for
every message
 that is signed.
If even just a few bits of the random value are predictable across multiple messages, then
the security of the signature scheme may be compromised. In the worst case,
the private key may be recoverable by an attacker. To counter these attacks,
JWT libraries  SHOULD implement ECDSA using the deterministic
approach defined in  <span>[<a href="#RFC6979" class="cite xref">RFC6979</a>]</span>.
This approach is completely compatible with existing ECDSA verifiers and so can be implemented
without new algorithm identifiers being required.<a href="#section-3.2-5.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="validate-crypto">
<section id="section-3.3">
        <h3 id="name-validate-all-cryptographic-">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-validate-all-cryptographic-" class="section-name selfRef">Validate All Cryptographic Operations</a>
        </h3>
<p id="section-3.3-1">All cryptographic operations used in the JWT MUST be validated and the entire JWT MUST be rejected
if any of them fail to validate.
This is true not only of JWTs with a single set of Header Parameters
but also for Nested JWTs in which both outer and inner operations  MUST be validated
using the keys and algorithms supplied by the application.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">Libraries MUST allow the verifier to distinguish between JWS-signed and JWE-encrypted JWTs.
This would allow verifiers to easily establish a policy of only accepting JWS-signed JWTs.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="validate-inputs">
<section id="section-3.4">
        <h3 id="name-validate-cryptographic-inpu">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-validate-cryptographic-inpu" class="section-name selfRef">Validate Cryptographic Inputs</a>
        </h3>
<p id="section-3.4-1">Some cryptographic operations, such as Elliptic Curve Diffie-Hellman key agreement
("ECDH-ES"), take inputs that may contain invalid values. This includes points not on
the specified elliptic curve
or other invalid points (e.g.,  <span>[<a href="#Valenta" class="cite xref">Valenta</a>]</span>, Section 7.1).
The JWS/JWE library itself must validate these inputs before using them,
or it must use underlying cryptographic libraries that do so (or both!).<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">Elliptic Curve Diffie-Hellman Ephemeral Static (ECDH-ES) ephemeral
 public key (epk) inputs should be validated
 according to the recipient's
chosen elliptic curve. For the NIST prime-order curves P-256, P-384, and P-521,
validation  MUST
be performed according to Section 5.6.2.3.4 (ECC Partial Public-Key Validation
Routine) of "Recommendation for Pair-Wise Key-Establishment Schemes Using Discrete Logarithm Cryptography"
<span>[<a href="#nist-sp-800-56a-r3" class="cite xref">nist-sp-800-56a-r3</a>]</span>.
If the "X25519" or "X448"  <span>[<a href="#RFC8037" class="cite xref">RFC8037</a>]</span> algorithms are used,
then the security considerations in  <span>[<a href="#RFC8037" class="cite xref">RFC8037</a>]</span> apply.<a href="#section-3.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-entropy">
<section id="section-3.5">
        <h3 id="name-ensure-cryptographic-keys-h">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-ensure-cryptographic-keys-h" class="section-name selfRef">Ensure Cryptographic Keys Have Sufficient Entropy</a>
        </h3>
<p id="section-3.5-1">The Key Entropy and Random Values advice in  Section 10.1 of <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span> and the
 Password Considerations in  Section 8.8 of <span>[<a href="#RFC7518" class="cite xref">RFC7518</a>]</span>
  MUST be followed.
In particular, human-memorizable passwords  MUST NOT be directly used
as the key to a keyed-MAC algorithm such as "HS256".
Moreover, passwords should only be used to perform key encryption, rather
than content encryption,
as described in  Section 4.8 of <span>[<a href="#RFC7518" class="cite xref">RFC7518</a>]</span>.
Note that even when used for key encryption, password-based encryption is
 still subject to brute-force attacks.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="no-compression">
<section id="section-3.6">
        <h3 id="name-avoid-compression-of-encryp">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-avoid-compression-of-encryp" class="section-name selfRef">Avoid Compression of Encryption Inputs</a>
        </h3>
<p id="section-3.6-1">Compression of data  SHOULD NOT be done before encryption, because
such compressed data often reveals information about the plaintext.<a href="#section-3.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-utf8">
<section id="section-3.7">
        <h3 id="name-use-utf-8">
<a href="#section-3.7" class="section-number selfRef">3.7. </a><a href="#name-use-utf-8" class="section-name selfRef">Use UTF-8</a>
        </h3>
<p id="section-3.7-1"><span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>,  <span>[<a href="#RFC7516" class="cite xref">RFC7516</a>]</span>, and  <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span> all
 specify that UTF-8 be used for encoding and decoding JSON
used in Header Parameters and JWT Claims Sets. This is also in line with the
latest JSON specification  <span>[<a href="#RFC8259" class="cite xref">RFC8259</a>]</span>.
Implementations and applications  MUST do this and not use or admit the use of
other Unicode encodings for these purposes.<a href="#section-3.7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="validate-iss-sub">
<section id="section-3.8">
        <h3 id="name-validate-issuer-and-subject">
<a href="#section-3.8" class="section-number selfRef">3.8. </a><a href="#name-validate-issuer-and-subject" class="section-name selfRef">Validate Issuer and Subject</a>
        </h3>
<p id="section-3.8-1">When a JWT contains an "iss" (issuer) claim, the application
  MUST validate that the cryptographic keys
used for the cryptographic operations in the JWT belong to the issuer.
If they do not, the application  MUST reject the JWT.<a href="#section-3.8-1" class="pilcrow">¶</a></p>
<p id="section-3.8-2">The means of determining the keys owned by an issuer is application-specific.
As one example, OpenID Connect  <span>[<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span>
issuer values are "https" URLs
that reference a JSON metadata document that contains a "jwks_uri" value that is
an "https" URL from which the issuer's keys are retrieved as a JWK Set  <span>[<a href="#RFC7517" class="cite xref">RFC7517</a>]</span>.
This same mechanism is used by  <span>[<a href="#RFC8414" class="cite xref">RFC8414</a>]</span>.
Other applications may use different means of binding keys to issuers.<a href="#section-3.8-2" class="pilcrow">¶</a></p>
<p id="section-3.8-3">Similarly, when the JWT contains a "sub" (subject) claim, the
 application  MUST validate that
the subject value corresponds to a valid subject and/or issuer-subject pair at the application.
This may include confirming that the issuer is trusted by the application.
If the issuer, subject, or the pair are invalid, the application
  MUST reject the JWT.<a href="#section-3.8-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-aud">
<section id="section-3.9">
        <h3 id="name-use-and-validate-audience">
<a href="#section-3.9" class="section-number selfRef">3.9. </a><a href="#name-use-and-validate-audience" class="section-name selfRef">Use and Validate Audience</a>
        </h3>
<p id="section-3.9-1">If the same issuer can issue JWTs that are intended for use by more
 than one relying party or application,
the JWT  MUST contain an "aud" (audience) claim that can be used
to determine whether the JWT
is being used by an intended party or was substituted by an attacker at an unintended party.<a href="#section-3.9-1" class="pilcrow">¶</a></p>
<p id="section-3.9-2">In such cases, the relying party or application  MUST
 validate the audience value,
and if the audience value is not present or not associated with the recipient,
it  MUST reject the JWT.<a href="#section-3.9-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="do-not-trust-claims">
<section id="section-3.10">
        <h3 id="name-do-not-trust-received-claim">
<a href="#section-3.10" class="section-number selfRef">3.10. </a><a href="#name-do-not-trust-received-claim" class="section-name selfRef">Do Not Trust Received Claims</a>
        </h3>
<p id="section-3.10-1">The "kid" (key ID) header is used by the relying application to
 perform key lookup. Applications
should ensure that this does not create SQL or LDAP injection vulnerabilities by validating
and/or sanitizing the received value.<a href="#section-3.10-1" class="pilcrow">¶</a></p>
<p id="section-3.10-2">Similarly, blindly following a "jku" (JWK set URL) or "x5u" (X.509 URL) header,
which may contain an arbitrary URL,
could result in server-side request forgery (SSRF) attacks. Applications SHOULD protect against such
attacks, e.g., by matching the URL to a whitelist of allowed locations
and ensuring no cookies are sent in the GET request.<a href="#section-3.10-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-typ">
<section id="section-3.11">
        <h3 id="name-use-explicit-typing">
<a href="#section-3.11" class="section-number selfRef">3.11. </a><a href="#name-use-explicit-typing" class="section-name selfRef">Use Explicit Typing</a>
        </h3>
<p id="section-3.11-1">Sometimes, one kind of JWT can be confused for another. If a particular
kind of JWT is subject to such confusion, that JWT can include an explicit
JWT type value, and the validation rules can specify checking the type.
This mechanism can prevent such confusion.
Explicit JWT typing is accomplished by using the "typ" Header Parameter.
For instance, the  <span>[<a href="#RFC8417" class="cite xref">RFC8417</a>]</span> specification uses
the "application/secevent+jwt" media type
to perform explicit typing of Security Event Tokens (SETs).<a href="#section-3.11-1" class="pilcrow">¶</a></p>
<p id="section-3.11-2">Per the definition of "typ" in  Section 4.1.9 of <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>,
it is  RECOMMENDED that the "application/" prefix be omitted from the "typ" value.
Therefore, for example, the "typ" value used to explicitly include a type for a SET SHOULD be "secevent+jwt".
When explicit typing is employed for a JWT, it is  RECOMMENDED
that a media type name of the format
"application/example+jwt" be used, where "example" is replaced by the
 identifier for the specific kind of JWT.<a href="#section-3.11-2" class="pilcrow">¶</a></p>
<p id="section-3.11-3">When applying explicit typing to a Nested JWT, the "typ" Header
 Parameter containing the explicit type value  MUST be present in the inner JWT of the Nested JWT (the JWT
whose payload is the JWT Claims Set).
In some cases, the same "typ" Header Parameter value will be present in the outer JWT as well,
to explicitly type the entire Nested JWT.<a href="#section-3.11-3" class="pilcrow">¶</a></p>
<p id="section-3.11-4">Note that the use of explicit typing may not achieve disambiguation
 from existing kinds of JWTs,
as the validation rules for existing kinds of JWTs often do not use the "typ" Header Parameter value.
Explicit typing is  RECOMMENDED for new uses of JWTs.<a href="#section-3.11-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="preventing-confusion">
<section id="section-3.12">
        <h3 id="name-use-mutually-exclusive-vali">
<a href="#section-3.12" class="section-number selfRef">3.12. </a><a href="#name-use-mutually-exclusive-vali" class="section-name selfRef">Use Mutually Exclusive Validation Rules for Different Kinds of JWTs</a>
        </h3>
<p id="section-3.12-1">Each application of JWTs defines a profile specifying the required
 and optional JWT claims
and the validation rules associated with them.
If more than one kind of JWT can be issued by the same issuer,
the validation rules for those JWTs  MUST be written such that
they are mutually exclusive,
rejecting JWTs of the wrong kind.
To prevent substitution of JWTs from one context into another,
application developers may employ a number of strategies:<a href="#section-3.12-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.12-2.1">
            <p id="section-3.12-2.1.1">Use explicit typing for different kinds of JWTs.
Then the distinct "typ" values can be used to differentiate between the
 different kinds of JWTs.<a href="#section-3.12-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.12-2.2">
            <p id="section-3.12-2.2.1">Use different sets of required claims or different required claim values.
Then the validation rules for one kind of JWT will reject those with different
 claims or values.<a href="#section-3.12-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.12-2.3">
            <p id="section-3.12-2.3.1">Use different sets of required Header Parameters or different
 required Header Parameter values.
Then the validation rules for one kind of JWT will reject those with different
 Header Parameters or values.<a href="#section-3.12-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.12-2.4">
            <p id="section-3.12-2.4.1">Use different keys for different kinds of JWTs.
Then the keys used to validate one kind of JWT will fail to validate other kinds of JWTs.<a href="#section-3.12-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.12-2.5">
            <p id="section-3.12-2.5.1">Use different "aud" values for different uses of JWTs from the same issuer.
Then audience validation will reject JWTs substituted into inappropriate contexts.<a href="#section-3.12-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.12-2.6">
            <p id="section-3.12-2.6.1">Use different issuers for different kinds of JWTs.
Then the distinct "iss" values can be used to segregate the different kinds of JWTs.<a href="#section-3.12-2.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.12-3">Given the broad diversity of JWT usage and applications,
the best combination of types, required claims, values, Header Parameters, key usages, and issuers
to differentiate among different kinds of JWTs
will, in general, be application-specific.
As discussed in  <a href="#use-typ" class="auto internal xref">Section 3.11</a>, for new JWT
 applications, the use of explicit typing is
  RECOMMENDED.<a href="#section-3.12-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="limit-iterations">
<section id="section-3.13">
        <h3 id="name-limit-hash-iteration-count">
<a href="#section-3.13" class="section-number selfRef">3.13. </a><a href="#name-limit-hash-iteration-count" class="section-name selfRef">Limit Hash Iteration Count</a>
        </h3>
<p id="section-3.13-1">Implementations are RECOMMENDED to set a reasonable upper limit on
the number of hash iterations that can be performed
when validating encrypted content using PBES2 encryption algorithms,
so as to prevent attackers from imposing
an unreasonable computational burden on recipients.
<span>[<a href="#OWASP-Password-Storage" class="cite xref">OWASP-Password-Storage</a>]</span> states that an iteration count of 600,000 is required when using HMAC-SHA-256 to achieve FIPS-140 compliance.
Thus, rejecting inputs with a <code>p2c</code> (PBES2 Count) value over 1,200,000 (double that) is RECOMMENDED.<a href="#section-3.13-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="token-format">
<section id="section-3.14">
        <h3 id="name-check-jwt-format-type">
<a href="#section-3.14" class="section-number selfRef">3.14. </a><a href="#name-check-jwt-format-type" class="section-name selfRef">Check JWT Format Type</a>
        </h3>
<p id="section-3.14-1">Implementations MUST confirm the JWT is in a legal format while parsing it. Legal JWTs contain only the ASCII characters for letters, numbers, dash, underscore, and period.  Content with any other characters - especially braces and quotation marks - is not a JWT and MUST be rejected.<a href="#section-3.14-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="limit-decompression">
<section id="section-3.15">
        <h3 id="name-limit-jwe-decompression-siz">
<a href="#section-3.15" class="section-number selfRef">3.15. </a><a href="#name-limit-jwe-decompression-siz" class="section-name selfRef">Limit JWE Decompression Size</a>
        </h3>
<p id="section-3.15-1">Implementations are RECOMMENDED to set a reasonable upper limit on the decompressed size of a JWE such as 250 KB.<a href="#section-3.15-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-4">
      <h2 id="name-security-considerations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-4-1">This entire document is about security considerations when
 implementing and deploying JSON Web Tokens.<a href="#section-4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-5">
      <h2 id="name-iana-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-5-1">This document has no IANA actions.<a href="#section-5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acknowledgements">
<section id="section-6">
      <h2 id="name-acknowledgements">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-6-1">Thanks to  Antonio Sanso for bringing the
 "ECDH-ES" invalid point attack to the attention
of JWE and JWT implementers.  Tim McLean published the
RSA/HMAC confusion attack  <span>[<a href="#McLean" class="cite xref">McLean</a>]</span>.
Thanks to  Nat Sakimura for advocating the use of
explicit typing. Thanks to  Neil Madden for his
numerous comments, and to Carsten Bormann, Brian Campbell, Brian Carpenter, Alissa Cooper, Roman Danyliw, Ben Kaduk,
Mirja Kühlewind, Barry Leiba, Eric Rescorla, Adam Roach, Martin Vigoureux,
and  Éric Vyncke
for their reviews.<a href="#section-6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-combined-references">
<section id="section-7">
      <h2 id="name-references">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-7.1">
        <h3 id="name-normative-references">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="nist-sp-800-56a-r3">[nist-sp-800-56a-r3]</dt>
        <dd>
<span class="refAuthor">Barker, E.</span>, <span class="refAuthor">Chen, L.</span>, <span class="refAuthor">Roginsky, A.</span>, <span class="refAuthor">Vassilev, A.</span>, and <span class="refAuthor">R. Davis</span>, <span class="refTitle">"Recommendation for pair-wise key-establishment schemes using discrete logarithm cryptography"</span>, <span class="refContent">National Institute of Standards and Technology</span>, <span class="seriesInfo">DOI 10.6028/nist.sp.800-56ar3</span>, <time datetime="2018-04" class="refDate">April 2018</time>, <span>&lt;<a href="https://doi.org/10.6028/nist.sp.800-56ar3">https://doi.org/10.6028/nist.sp.800-56ar3</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6979">[RFC6979]</dt>
        <dd>
<span class="refAuthor">Pornin, T.</span>, <span class="refTitle">"Deterministic Usage of the Digital Signature Algorithm (DSA) and Elliptic Curve Digital Signature Algorithm (ECDSA)"</span>, <span class="seriesInfo">RFC 6979</span>, <span class="seriesInfo">DOI 10.17487/RFC6979</span>, <time datetime="2013-08" class="refDate">August 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6979">https://www.rfc-editor.org/rfc/rfc6979</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7515">[RFC7515]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Signature (JWS)"</span>, <span class="seriesInfo">RFC 7515</span>, <span class="seriesInfo">DOI 10.17487/RFC7515</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7515">https://www.rfc-editor.org/rfc/rfc7515</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7516">[RFC7516]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span> and <span class="refAuthor">J. Hildebrand</span>, <span class="refTitle">"JSON Web Encryption (JWE)"</span>, <span class="seriesInfo">RFC 7516</span>, <span class="seriesInfo">DOI 10.17487/RFC7516</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7516">https://www.rfc-editor.org/rfc/rfc7516</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7518">[RFC7518]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refTitle">"JSON Web Algorithms (JWA)"</span>, <span class="seriesInfo">RFC 7518</span>, <span class="seriesInfo">DOI 10.17487/RFC7518</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7518">https://www.rfc-editor.org/rfc/rfc7518</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7519">[RFC7519]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7519">https://www.rfc-editor.org/rfc/rfc7519</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8017">[RFC8017]</dt>
        <dd>
<span class="refAuthor">Moriarty, K., Ed.</span>, <span class="refAuthor">Kaliski, B.</span>, <span class="refAuthor">Jonsson, J.</span>, and <span class="refAuthor">A. Rusch</span>, <span class="refTitle">"PKCS #1: RSA Cryptography Specifications Version 2.2"</span>, <span class="seriesInfo">RFC 8017</span>, <span class="seriesInfo">DOI 10.17487/RFC8017</span>, <time datetime="2016-11" class="refDate">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8017">https://www.rfc-editor.org/rfc/rfc8017</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8037">[RFC8037]</dt>
        <dd>
<span class="refAuthor">Liusvaara, I.</span>, <span class="refTitle">"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)"</span>, <span class="seriesInfo">RFC 8037</span>, <span class="seriesInfo">DOI 10.17487/RFC8037</span>, <time datetime="2017-01" class="refDate">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8037">https://www.rfc-editor.org/rfc/rfc8037</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8259">[RFC8259]</dt>
      <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">STD 90</span>, <span class="seriesInfo">RFC 8259</span>, <span class="seriesInfo">DOI 10.17487/RFC8259</span>, <time datetime="2017-12" class="refDate">December 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8259">https://www.rfc-editor.org/rfc/rfc8259</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-7.2">
        <h3 id="name-informative-references">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="Alawatugoda">[Alawatugoda]</dt>
        <dd>
<span class="refAuthor">Alawatugoda, J.</span>, <span class="refAuthor">Stebila, D.</span>, and <span class="refAuthor">C. Boyd</span>, <span class="refTitle">"Protecting Encrypted Cookies from Compression Side-Channel Attacks"</span>, <span class="refContent">Springer Berlin Heidelberg</span>, <span class="seriesInfo">Lecture Notes in Computer Science pp. 86-106</span>, <span class="seriesInfo">DOI 10.1007/978-3-662-47854-7_6</span>, <span class="seriesInfo">ISBN ["9783662478530", "9783662478547"]</span>, <time datetime="2015" class="refDate">2015</time>, <span>&lt;<a href="https://doi.org/10.1007/978-3-662-47854-7_6">https://doi.org/10.1007/978-3-662-47854-7_6</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ANSI-X962-2005">[ANSI-X962-2005]</dt>
        <dd>
<span class="refAuthor">American National Standards Institute</span>, <span class="refTitle">"Public Key Cryptography for the Financial Services Industry: the Elliptic Curve Digital Signature Algorithm (ECDSA)"</span>, <time datetime="2005-11" class="refDate">November 2005</time>. </dd>
<dd class="break"></dd>
<dt id="CVE-2015-9235">[CVE-2015-9235]</dt>
        <dd>
<span class="refAuthor">NIST</span>, <span class="refTitle">"CVE-2015-9235 Detail"</span>, <span class="refContent">National Vulnerability Database</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://nvd.nist.gov/vuln/detail/CVE-2015-9235">https://nvd.nist.gov/vuln/detail/CVE-2015-9235</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CVE-2023-51774">[CVE-2023-51774]</dt>
        <dd>
<span class="refAuthor">NIST</span>, <span class="refTitle">"CVE-2023-51774 Detail"</span>, <span class="refContent">National Vulnerability Database</span>, <time datetime="2024-02" class="refDate">February 2024</time>, <span>&lt;<a href="https://nvd.nist.gov/vuln/detail/CVE-2023-51774">https://nvd.nist.gov/vuln/detail/CVE-2023-51774</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Kelsey">[Kelsey]</dt>
        <dd>
<span class="refAuthor">Kelsey, J.</span>, <span class="refTitle">"Compression and Information Leakage of Plaintext"</span>, <span class="refContent">Springer Berlin Heidelberg</span>, <span class="seriesInfo">Lecture Notes in Computer Science pp. 263-276</span>, <span class="seriesInfo">DOI 10.1007/3-540-45661-9_21</span>, <span class="seriesInfo">ISBN ["9783540440093", "9783540456612"]</span>, <time datetime="2002" class="refDate">2002</time>, <span>&lt;<a href="https://doi.org/10.1007/3-540-45661-9_21">https://doi.org/10.1007/3-540-45661-9_21</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Langkemper">[Langkemper]</dt>
        <dd>
<span class="refAuthor">Langkemper, S.</span>, <span class="refTitle">"Attacking JWT authentication"</span>, <time datetime="2016-09" class="refDate">September 2016</time>, <span>&lt;<a href="https://www.sjoerdlangkemper.nl/2016/09/28/attacking-jwt-authentication/">https://www.sjoerdlangkemper.nl/2016/09/28/attacking-jwt-authentication/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="McLean">[McLean]</dt>
        <dd>
<span class="refAuthor">McLean, T.</span>, <span class="refTitle">"Critical vulnerabilities in JSON Web Token libraries"</span>, <time datetime="2015-03" class="refDate">March 2015</time>, <span>&lt;<a href="https://auth0.com/blog/critical-vulnerabilities-in-json-web-token-libraries/">https://auth0.com/blog/critical-vulnerabilities-in-json-web-token-libraries/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OpenID.Core">[OpenID.Core]</dt>
        <dd>
<span class="refAuthor">Sakimura, N.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Jones, M.</span>, <span class="refAuthor">de Medeiros, B.</span>, and <span class="refAuthor">C. Mortimore</span>, <span class="refTitle">"OpenID Connect Core 1.0 incorporating errata set 2"</span>, <time datetime="2023-12" class="refDate">December 2023</time>, <span>&lt;<a href="https://openid.net/specs/openid-connect-core-1_0.html">https://openid.net/specs/openid-connect-core-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OWASP-Password-Storage">[OWASP-Password-Storage]</dt>
        <dd>
<span class="refAuthor">OWASP</span>, <span class="refTitle">"Password Storage Cheat Sheet"</span>, <span class="seriesInfo">OWASP Cheat Sheet Series </span>, <time datetime="2025" class="refDate">2025</time>, <span>&lt;<a href="https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html">https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6749">[RFC6749]</dt>
        <dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6749">https://www.rfc-editor.org/rfc/rfc6749</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7159">[RFC7159]</dt>
        <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">RFC 7159</span>, <span class="seriesInfo">DOI 10.17487/RFC7159</span>, <time datetime="2014-03" class="refDate">March 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7159">https://www.rfc-editor.org/rfc/rfc7159</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7517">[RFC7517]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refTitle">"JSON Web Key (JWK)"</span>, <span class="seriesInfo">RFC 7517</span>, <span class="seriesInfo">DOI 10.17487/RFC7517</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7517">https://www.rfc-editor.org/rfc/rfc7517</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8414">[RFC8414]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Sakimura, N.</span>, and <span class="refAuthor">J. Bradley</span>, <span class="refTitle">"OAuth 2.0 Authorization Server Metadata"</span>, <span class="seriesInfo">RFC 8414</span>, <span class="seriesInfo">DOI 10.17487/RFC8414</span>, <time datetime="2018-06" class="refDate">June 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8414">https://www.rfc-editor.org/rfc/rfc8414</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8417">[RFC8417]</dt>
        <dd>
<span class="refAuthor">Hunt, P., Ed.</span>, <span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Denniss, W.</span>, and <span class="refAuthor">M. Ansari</span>, <span class="refTitle">"Security Event Token (SET)"</span>, <span class="seriesInfo">RFC 8417</span>, <span class="seriesInfo">DOI 10.17487/RFC8417</span>, <time datetime="2018-07" class="refDate">July 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8417">https://www.rfc-editor.org/rfc/rfc8417</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Sanso">[Sanso]</dt>
        <dd>
<span class="refAuthor">Sanso, A.</span>, <span class="refTitle">"Critical Vulnerability Uncovered in JSON Encryption"</span>, <time datetime="2017-03" class="refDate">March 2017</time>, <span>&lt;<a href="https://blogs.adobe.com/security/2017/03/critical-vulnerability-uncovered-in-json-encryption.html">https://blogs.adobe.com/security/2017/03/critical-vulnerability-uncovered-in-json-encryption.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Valenta">[Valenta]</dt>
      <dd>
<span class="refAuthor">Valenta, L.</span>, <span class="refAuthor">Sullivan, N.</span>, <span class="refAuthor">Sanso, A.</span>, and <span class="refAuthor">N. Heninger</span>, <span class="refTitle">"In search of CurveSwap: Measuring elliptic curve implementations in the wild"</span>, <time datetime="2018-03" class="refDate">March 2018</time>, <span>&lt;<a href="https://ia.cr/2018/298">https://ia.cr/2018/298</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="autogen-document-history">
<section id="appendix-A">
      <h2 id="name-document-history">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<p id="appendix-A-1">[[Note to RFC Editor: please remove before publication.]]<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div id="autogen-draft-ietf-oauth-rfc8725bis-00">
<section id="appendix-A.1">
        <h3 id="name-draft-ietf-oauth-rfc8725bis">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-draft-ietf-oauth-rfc8725bis" class="section-name selfRef">draft-ietf-oauth-rfc8725bis-00</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-A.1-1.1">
            <p id="appendix-A.1-1.1.1">Draft adopted, no textual changes<a href="#appendix-A.1-1.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="autogen-draft-sheffer-oauth-rfc8725bis-02">
<section id="appendix-A.2">
        <h3 id="name-draft-sheffer-oauth-rfc8725">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-draft-sheffer-oauth-rfc8725" class="section-name selfRef">draft-sheffer-oauth-rfc8725bis-02</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-A.2-1.1">
            <p id="appendix-A.2-1.1.1">Obsoletes RFC 8725 and updates RFC 7519.<a href="#appendix-A.2-1.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="autogen-draft-sheffer-oauth-rfc8725bis-01">
<section id="appendix-A.3">
        <h3 id="name-draft-sheffer-oauth-rfc8725b">
<a href="#appendix-A.3" class="section-number selfRef">A.3. </a><a href="#name-draft-sheffer-oauth-rfc8725b" class="section-name selfRef">draft-sheffer-oauth-rfc8725bis-01</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-A.3-1.1">
            <p id="appendix-A.3-1.1.1">Mitigate encryption-signature confusion.<a href="#appendix-A.3-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.3-1.2">
            <p id="appendix-A.3-1.2.1">Reject unreasonably large <code>p2c</code> (PBES2 Count) values.<a href="#appendix-A.3-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.3-1.3">
            <p id="appendix-A.3-1.3.1">Defensive checking to address incorrect reading of <code>alg</code> values as being case-insensitive.<a href="#appendix-A.3-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.3-1.4">
            <p id="appendix-A.3-1.4.1">Mitigate DoS attacks resulting from abuse of compression.<a href="#appendix-A.3-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.3-1.5">
            <p id="appendix-A.3-1.5.1">Mitigate JWT serialization format confusion.<a href="#appendix-A.3-1.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="autogen-draft-sheffer-oauth-rfc8725bis-00">
<section id="appendix-A.4">
        <h3 id="name-draft-sheffer-oauth-rfc8725bi">
<a href="#appendix-A.4" class="section-number selfRef">A.4. </a><a href="#name-draft-sheffer-oauth-rfc8725bi" class="section-name selfRef">draft-sheffer-oauth-rfc8725bis-00</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-A.4-1.1">
            <p id="appendix-A.4-1.1.1">Initial version, text is identical to RFC 8725.<a href="#appendix-A.4-1.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Yaron Sheffer</span></div>
<div dir="auto" class="left"><span class="org">Intuit</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:yaronf.ietf@gmail.com" class="email">yaronf.ietf@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Dick Hardt</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:dick.hardt@gmail.com" class="email">dick.hardt@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Michael B. Jones</span></div>
<div dir="auto" class="left"><span class="org">Self-Issued Consulting</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:michael_b_jones@hotmail.com" class="email">michael_b_jones@hotmail.com</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://self-issued.info/" class="url">https://self-issued.info/</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
